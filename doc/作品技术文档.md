# **第1章**      作品概述

在传统的超市和菜市场中，称重环节是消费者购买商品时必不可少的一环。然而， 传统的称重方式存在一些问题，例如工作人员任务繁重、消费者需要排队等候等等。为了 解决这些问题，本研究采用树莓派设计了一个果蔬拍照识别的物联网电子秤软件，以便更 加方便快捷地进行称重和结账。  

本研究的树莓派电子秤软件主要由四个模块组成：拍照识别模块、传感器称重模块、 数据存储模块和显示模块。拍照识别模块通过摄像头拍照识别果蔬商品的类型，并从数据 库中获取称重果蔬商品的价格信息，实时计算果蔬商品的总价。传感器称重模块则可以实 时检测称重数据，并将其传输到软件中进行计算。数据存储模块可以存储商品信息、价格 信息、以及结算记录等数据，以便进行查询和管理。显示模块则可以显示商品信息、价格 和结算信息等，同时还可以打印条形码或二维码进行结账。 

在技术层面，本设计采用了卷积神经网络算法实现了果蔬识别，并使用Python语言编 写代码、PyQt6设计界面，并与MySQL数据库进行交互。最终结果表明，本研究的树莓派 电子秤软件可以快速、准确地识别果蔬商品，并进行实时计算和结算，具有较高的实用价 值和应用前景。

【简要表述作品的名称、应用领域、主要功能、创新性说明（包括设计思路创新性、技术创新性、硬件创新性、应用创新性等）等】

# **第2章**      需求分析



【本部分内容建议不超过1000字，简要说明为什么开发本作品，是否存在竞品，对标什么作品以及面向的用户、主要功能、主要性能等。建议有竞品分析表格，从多个维度分析本作品与竞品作品比较】

# **第3章**      技术方案

## 3.1 硬件平台设计

### 3.1.1 硬件连接布局



### 3.1.2 树莓派的环境配置与硬件操作



## 3.2 软件平台设计

### 3.2.1 基于 PyTorch 的识别模型与包装



### 3.2.2 用户交互界面



【包括硬件组成与来源、代码、系统设计图、功能描述；

接口具有通用性与可扩展性、代码规范；

硬件设计合理，选材、组配、布线规范，无安全隐患；

自主知识产权技术说明】

# **第4章**      方案实现

## 4.1 树莓派的环境配置与硬件操作

### 4.1.1 称重模块与 usb 摄像头模块

*opencv使用摄像头，树莓派连接 HX711AD 转换模块以及圆形托盘组合为称重模块*

### 4.1.2 树莓派环境与运行模式

*通过创建 Python 虚拟环境并安装对应库，通过 X11 转发在本地显示 GUI 窗口*

## 4.2 用户交互操作

### 4.2.1 基于 PyTorch 框架的果蔬识别模型

为了实现果蔬的自动识别，本系统采用了基于卷积神经网络（CNN）的深度学习模型，具体使用了 PyTorch 框架来构建和训练模型。以下是实现该模型的详细过程。

1. 模型选择

在果蔬识别任务中，由于图像分类的需求，我们选择了**ResNet-18**作为基础模型。ResNet（Residual Network）是一种在深度学习中广泛应用的卷积神经网络，它通过残差学习（Residual Learning）有效解决了深度神经网络训练中的梯度消失问题，使得网络可以更加深层次且高效地学习。

ResNet-18是ResNet系列中参数较少的一个变种，它包含18层的神经网络结构，适用于对计算资源要求不高且数据量较小的任务。通过微调（fine-tuning）ResNet-18模型，我们可以快速适应果蔬识别任务。

2. 数据准备

为了训练模型，我们首先准备了果蔬图像数据集。数据集被分为训练集和测试集，并存储在本地文件夹中。每个果蔬品类的图片都被组织在不同的文件夹中，且每个文件夹命名为对应的果蔬类别名称。具体的图片预处理操作如下：

- **图像尺寸调整**：将输入图像统一调整为128x128像素，以适应网络输入要求。
- **数据增强**：通过随机水平翻转、旋转等操作增强训练数据的多样性，帮助模型泛化。
- **归一化**：对图像数据进行标准化处理，确保像素值分布在[0,1]范围内。

```python
transform = transforms.Compose([
    transforms.Resize((128, 128)),
    transforms.ToTensor(),
    transforms.Normalize(0, 1)
])
```

3. 模型设计与训练

使用PyTorch的`torchvision.models`模块，我们可以直接加载一个预训练的ResNet-18模型，并对其进行微调以适应我们的数据集。我们仅保留网络的前几层（特征提取部分），然后替换掉全连接层，使其输出类别数等于果蔬种类的数量。

模型的微调步骤如下：

- 使用预训练的ResNet-18模型作为初始化。
- 修改最后的全连接层，使其输出类别数等于果蔬数据集的类别数（在本项目中，假设为30种）。
- 设置合适的优化器和学习率，进行训练。

```python
model = models.resnet18(pretrained=True)
model.fc = nn.Linear(model.fc.in_features, num_classes)
model.to(device)
```

在训练过程中，采用交叉熵损失函数（`CrossEntropyLoss`）和Adam优化器（`torch.optim.Adam`）进行模型的训练和优化。

4. 模型评估与测试

训练完成后，模型会在测试集上进行评估。评估时，我们计算分类准确率（Accuracy）和损失函数值（Loss），以便评估模型在未知数据上的表现。

```
......

epoch20
100%|███████████████████████████████████████████████████████████| 98/98 [04:15<00:00,  2.61s/it]
training Accuracy: 98.6
100%|███████████████████████████████████████████████████████████| 12/12 [00:32<00:00,  2.68s/it]
Test Accuracy: 96.10%, Test Avg loss: 0.128465
```

5. 部署与应用

训练完成的模型可以导出为 `.pth` 格式，保存在树莓派上。当用户将果蔬放置在称重平台上时，系统通过连接的USB摄像头捕捉图像，并将图像输入到训练好的果蔬识别模型中。模型对输入图像进行预测，识别出物品的类别，并根据数据库中的价格信息进行实时结算。

```python
torch.save(model, 'fruit_vegetable_model.pth')
```

6. 模型的优化与扩展

为提高模型的准确性和鲁棒性，我们还可以进行如下优化：

- **数据增强**：增加更多种类的增强方法，如旋转、缩放、色彩变换等。
- **更多类别的训练数据**：通过增加数据集中的样本数和种类，提高模型的泛化能力。
- **迁移学习**：尝试其他模型（如ResNet-34、VGG等），对比不同模型在任务中的表现。

#### 7. 总结

通过使用基于ResNet-18的深度学习模型，本系统能够较为准确地识别不同种类的果蔬，并实现自动结算。通过对PyTorch框架的高效使用，以及结合硬件平台的实时识别需求，系统能够实现较为流畅且精确的果蔬识别。

### 4.2.2 视频与图像边缘处理



### 4.2.3 用户交互界面

【说明实物系统中每个组成部分的功能、以及功能实现的技术细节】

# **第5章**      测试报告



【测试报告中应详细说明作品实物系统与设计方案中所设计的各项性能指标的符合度、实物系统中各功能模块的实际效能等】

# **第6章**      应用前景



【该系统在相应应用领域中的使用情况，或者使用前景】

# 参考文献



【请按照标准参考文件格式填写】

 

 